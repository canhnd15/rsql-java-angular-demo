<div class="card">
  <h2>Orders Management</h2>
  
  <!-- Filters -->
  <div class="filters">
    <div class="form-group">
      <label for="customerFilter">Customer Name:</label>
      <input 
        type="text" 
        id="customerFilter" 
        class="form-control" 
        [(ngModel)]="customerFilter" 
        (input)="applyFilters()"
        placeholder="Filter by customer name">
    </div>
    
    <div class="form-group">
      <label for="statusFilter">Status:</label>
      <select 
        id="statusFilter" 
        class="form-control" 
        [(ngModel)]="statusFilter" 
        (change)="applyFilters()">
        <option value="">All Statuses</option>
        <option value="PENDING">Pending</option>
        <option value="CONFIRMED">Confirmed</option>
        <option value="SHIPPED">Shipped</option>
        <option value="DELIVERED">Delivered</option>
        <option value="CANCELLED">Cancelled</option>
      </select>
    </div>
    
    <div class="form-group">
      <label for="sortBy">Sort By:</label>
      <select 
        id="sortBy" 
        class="form-control" 
        [(ngModel)]="sortBy" 
        (change)="applySorting()">
        <option value="">No Sorting</option>
        <option value="createdAt:desc">Created Date (Newest)</option>
        <option value="createdAt:asc">Created Date (Oldest)</option>
        <option value="totalAmount:desc">Total Amount (High to Low)</option>
        <option value="totalAmount:asc">Total Amount (Low to High)</option>
        <option value="customerName:asc">Customer Name (A-Z)</option>
        <option value="customerName:desc">Customer Name (Z-A)</option>
      </select>
    </div>
  </div>

  <!-- Loading indicator -->
  <div *ngIf="loading" class="loading">
    Loading orders...
  </div>

  <!-- Error message -->
  <div *ngIf="error" class="error">
    {{ error }}
  </div>

  <!-- Orders table -->
  <div *ngIf="!loading && !error">
    <table class="table">
      <thead>
        <tr>
          <th>Order Number</th>
          <th>Customer</th>
          <th>Email</th>
          <th>Total Amount</th>
          <th>Status</th>
          <th>Created Date</th>
        </tr>
      </thead>
      <tbody>
        <ng-container *ngFor="let order of orders">
          <tr class="order-row">
            <td>{{ order.orderNumber }}</td>
            <td>{{ order.customerName }}</td>
            <td>{{ order.customerEmail }}</td>
            <td>${{ order.totalAmount | number:'1.2-2' }}</td>
            <td>
              <span class="status-badge status-{{ order.status.toLowerCase() }}">
                {{ order.status }}
              </span>
            </td>
            <td>{{ order.createdAt | date:'medium' }}</td>
          </tr>
          <tr class="details-row" *ngIf="order.orderDetails?.length">
            <td colspan="6">
              <table class="table nested">
                <thead>
                  <tr>
                    <th style="width: 30%">Product</th>
                    <th style="width: 15%">SKU</th>
                    <th style="width: 15%">Qty</th>
                    <th style="width: 20%">Unit Price</th>
                    <th style="width: 20%">Total</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let d of order.orderDetails">
                    <td>{{ d.productName }}</td>
                    <td>{{ d.productSku }}</td>
                    <td>{{ d.quantity }}</td>
                    <td>${{ d.unitPrice | number:'1.2-2' }}</td>
                    <td>${{ d.totalPrice | number:'1.2-2' }}</td>
                  </tr>
                </tbody>
              </table>
            </td>
          </tr>
        </ng-container>
      </tbody>
    </table>

    <!-- Pagination -->
    <div class="pagination" *ngIf="totalPages > 1">
      <button 
        class="btn btn-secondary" 
        [disabled]="currentPage === 0" 
        (click)="goToPage(currentPage - 1)">
        Previous
      </button>
      
      <span class="page-info">
        Page {{ currentPage + 1 }} of {{ totalPages }}
        ({{ totalElements }} total orders)
      </span>
      
      <button 
        class="btn btn-secondary" 
        [disabled]="currentPage >= totalPages - 1" 
        (click)="goToPage(currentPage + 1)">
        Next
      </button>
    </div>
  </div>
</div>
